"*Note: This post is geared towards developers who may not have much experience with implementing an OAuth workflow using GitHub before. This will walk through my implementation of the workflow.* \n\nDuring this post, these technologies will be covered:\n\n- JavaScript\n- NodeJS and yarn\n- HTML\n\nIf you're not comfortable yet with these technologies here are some links which might help you getting started:\n\n- [Intro to HTML](https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML)\n\n- [Intro to JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Introduction)\n\n- [nodeguide](http://nodeguide.com/beginner.html)\n\nThis post also assumes two things:\n\n- that you have a GitHub account, if you don't have one, you should sign up! It is free! [GitHub Sign Up](https://help.github.com/articles/signing-up-for-a-new-github-account/)\n\n- that you are comfortable working in a command line terminal to use NodeJS/git ( if you're not comfortable yet, check out the [nodeguide](http://nodeguide.com/beginner.html#the-interactive-node.js-shell) above )\n\nTake the time you need to get comfortable, these pieces will be important going forward!\n\nOnce we're ready, the next step will be to register an application with GitHub which will give us access to a couple pieces of important information. These pieces of information will be important during the authentication process, we'll talk about them shortly. To set this up, open the [GitHub Developer Settings](https://github.com/settings/developers) which should take you right to the developers portion of your GitHub settings. Now, there should be a button in the top right hand corner labeled `Register a new application`. You'll want to click this, this should present you with a form to fill out to register your application. Here is an example of what the form could look like (I filled it out with some example details that you could use to follow along). Feel free to enter with any information that you would like to. You're free to set up as many of these as you like, so we can treat this one for demo purposes only, and we can delete it in the future if needed.\n\nProbably the most important piece of information in this form is the authorization callback URL. This URL is important because this is the place in our app that GitHub will call to finish the authorization process. This will need to match with what we provide. Once everything has been filled out, click the shiny green `Register application` button at the bottom to complete the registration!\n\nOnce registered, GitHub is going to give us the two pieces of information we need, the `Client ID` and the `Client Secret`. It's important to note here that the `Client Secret` should never be shared with anyone, and it certainly should never be embedded in code that is being checked into GitHub nor should it be shared on the client! One way to persist these pieces of information so that they are only available on the server, and not included in the source code, is to store them into a dotfile locally on your machine. This file can then be referenced to be loaded into memory when the shell session is started. If you would like more information about this, checkout this article which goes into more depth about this subject! [BASH Environment and Shell Variables](http://www.tricksofthetrades.net/2015/06/14/notes-bash-env-variables/). You are going to see these variables referenced in future code snippets using `process.env.XXXXX` which is NodeJS' mechanism to access the shell environment variables.\n\nSweet, now that we have everything we need from GitHub, we can start coding the app! To get started, we'll want to init a project from the command line. Open up your favorite terminal and go into a directory where you might host any projects and enter the following commands:\n\n```sh\nmkdir github-oauth-demo\ncd github-oauth-demo\nyarn init\n```\nCool, we've initialized the project with [yarn](https://yarnpkg.com) so we are ready to start installing some packages! The only package we're going to need is [express](https://expressjs.com/) which will be the server framework on the Node side.\n\n```sh\nyarn add express\n```\n\nEasy peasy! Now, let's stay with the server and let's setup the code that will be needed to serve a static html page and accept requests from the client:\n\n**_index.js_**:\n\n```js\nconst http = require('http');\nconst https = require('https');\nconst express = require('express');\nconst app = express();\n\nconst port = 1337;\n\napp.use(express.static(__dirname));\n\nconst server = http.createServer(app);\n\nserver.listen(port, () => {\n  console.log(`==> Server is listening on port ${port}`);\n  console.log(`==> Ã°ÂÂÂ  Go to localhost:${port}`);\n});\n```\n\nOk, this is the most basic necessary code that we need to get going and serve up static files. In our case, the only static asset that we will be serving up will be an `index.html` file that will be the basis of our demo. So basically, the code above is what accomplishes that. Ok, let's add the `index.html` file really quick since we have the server code setup. We can then test it out and make sure the server is serving up everything smoothly.\n\n**_index.html_**:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <meta name=\"author\" content=\"mike\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0\">\n\n    <title>GitHub OAuth Demo</title>\n    \n    <link rel=\"shortcut icon\" href=\"favicon.ico\" type=\"image/x-icon\" />\n  </head>\n  <body class=\"landing\">\n    <header role=\"banner\">\n      <h1>GitHub OAuth Demo</h1>\n    </header>\n\n    <main role=\"main\">\n      <section>\n        <button>Login To GitHub</button>\n      </section>\n    </main>\n  </body>\n</html>\n```\nOk, great! There isn't much to see here yet. We haven't added the click functionality for the button yet. Let's first quickly test this and make sure that it's running as expected... go back to the terminal, and from the project folder run `node index.js`. This should start the server on `localhost:1337`. Open the browser, and you should see the page load successfully with some text loaded. \n\nNow, let's stay with the client and add the functionality that will happen when the user clicks on the button. Basically, here's what is going to happen when the user clicks on the login button: the page is going to open a new popup window that will be directed to the GitHub oauth login URL. This URL is going to provide instructions of where to callback to via the `redirect_uri`. It's also going to include the client ID that was one of the pieces of information received when registering the GitHub application earlier.\n\n```js\nfunction login() {\n    // handle messages received from popup window\n    const receiveMessage = event => {\n      // Do we trust the sender of this message?\n      if (event.origin !== window.location.origin) {\n        return;\n      }\n\n      // remove the listener as we should only receive one message\n      window.removeEventListener(\"message\", receiveMessage, false);\n\n      // close the window\n      githubWindow.close();\n\n    // listen for messages back from popup\n    window.addEventListener(\"message\", receiveMessage, false);\n\n    // open the popup\n    const githubWindow = window.open(\n      `https://github.com/login/oauth/authorize?client_id=${process.env.GITHUB_CLIENT_ID}&scope=user%20public_repo&redirect_uri=http://localhost:1337/callback`,\n      \"GitHubLogin\",\n      \"menubar=no,location=yes,resizable=yes,status=yes,width=786,height=534\"\n    );\n}\n```\n\nAlright, so there is a lot going on here so let's take a minute to understand what is going on. When the user clicks on the login button, it's going to call this function `login`. This is going to setup an event listener to listen for messages to this window. Next, it's going to open up a popup to the GitHub login address. This popup is where the user will accept to authorize this application, allowing them to login as themselves. As you see above, it requires that the GitHub Client ID is included in this call. In this example, I am going to include the CLIENT ID on the client side. However, the SECRET will never be exposed, it's going to always stay in an environment variable! Basically, what's going to happen is that we're going to use the [Post Message API](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) to message from the popup window back to the original window that opened it once we have completed the handshake to get the access token. Remember, to use the GitHub API for certain things such as reading or writing to a repository, we need the access token to be passed in the headers. So really, we just need this access token and then we are golden! There is some extra code getTokenFromString which is doing to helper work to strip out the access token from the response. You can see the full example of this code in the accompanying demo.\n\nOk, we're really close now!. Basically now we just need to setup the endpoint on the server which will handle the callback from the github API in the popup window.\n\n```js\napp.get(\"/callback\", function(req, res) {\n  const data = JSON.stringify({\n    client_id: process.env.OAUTH_DEMO_GITHUB_CLIENT_ID,\n    client_secret: process.env.OAUTH_DEMO_GITHUB_CLIENT_SECRET,\n    code: req.query.code\n  });\n\n  const options = {\n    host: \"github.com\",\n    port: \"443\",\n    path: \"/login/oauth/access_token\",\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Content-Length\": Buffer.byteLength(data)\n    }\n  };\n\n  const post_req = https.request(\n    options,\n    function(resp) {\n      resp.setEncoding(\"utf8\");\n      resp.on(\"data\", function(chunk) {\n        console.log(\"GitHub API Response: \" + chunk);\n        res.send(\n          `<html><body><script>window.opener.postMessage(\"${chunk}\", '*')</script></body></html>`\n        );\n      });\n    },\n    function(err) {\n      console.log(\"error\", err);\n    }\n  );\n\n  post_req.write(data);\n  post_req.end();\n});\n```\nOk, so there is a little magic that is happening here. Basically, this route on our server is being called from the popup window as the callback. It's going to pass a code from the GitHub and the popup to this endpoint. In turn, this code will be used along with the client id and client secret to get the access token from GitHub. It will make the POST call to GitHub to obtain the access token, once it successfully completes, I embed this into the script tag of the HTML which will post the message once the page initializes. Then, the client will have the access token, and they are free to make any authorized requests on behalf of the logged in GitHub user!\n\n## Conclusion \n\nThat will complete this tutorial. I have the full solution posted [here](https://github.com/mjw56/github-oauth-demo) in case anything in the article did not make sense. I hope this was helpful! If there is anything that did not make sense, please feel free to reach out with any questions or comments you might have. Your feedback is most welcome!\n\nThanks for reading!"